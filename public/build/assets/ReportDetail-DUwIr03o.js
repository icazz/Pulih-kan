import{r as z,c as f,m as _,a as o,b,d as e,u as i,h as A,w as L,f as d,l as I,t as a,n as x,F as j,i as T,e as u,g as E,v as R,k as h,o as n}from"./app-ChzUFhyI.js";import{_ as U}from"./Navbar-DOKeF_Ye.js";const V={class:"min-h-screen bg-[#FFFDF4] font-['Montserrat'] pb-20"},N={class:"w-full bg-gradient-to-r from-[#8FC555] to-[#4B692D] pt-32 pb-16 px-6"},Q={class:"max-w-6xl mx-auto"},H={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4"},O={class:"flex flex-wrap items-center gap-3"},G={class:"text-white text-4xl font-bold"},J={class:"text-white/80 text-xl mt-3 font-light"},q={class:"max-w-6xl mx-auto px-6 mt-10 grid grid-cols-1 lg:grid-cols-3 gap-8"},W={class:"lg:col-span-2 space-y-8"},Y={class:"space-y-6"},X={class:"flex gap-4"},Z={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex-1 mb-4"},ee={class:"space-y-4 text-sm bg-gray-50 p-4 rounded-xl border border-gray-100"},te={class:"text-gray-800 font-medium capitalize"},re={class:"text-gray-700 leading-relaxed"},se={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-2"},oe=["href"],ae=["src"],ne={key:1,class:"w-full h-full bg-black flex items-center justify-center text-white group-hover:bg-gray-900 transition"},le={key:1,class:"w-full p-4 bg-gray-50 rounded-xl border border-gray-200 text-center border-dashed"},ie={class:"flex gap-4"},de={class:"flex flex-col items-center"},ce={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex-1"},pe={class:"flex flex-col sm:flex-row gap-3"},ue={class:"flex-1 w-full"},ge={key:0,class:"mt-2 text-center"},xe=["href"],fe=["href"],be={class:"space-y-6"},he={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100"},me={class:"space-y-4"},ke={key:0},ye={class:"flex gap-2 mt-2"},ve=["disabled"],we={key:0,class:"text-red-500 text-[10px] mt-1"},Be={key:1,class:"space-y-3"},_e={class:"pt-4 border-t border-gray-50 flex justify-between items-center"},je={class:"text-lg font-bold text-[#BB4D00]"},De={key:0,class:"bg-orange-100 text-orange-600 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide"},Ce={key:1,class:"bg-green-100 text-green-600 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide"},Fe={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100"},Me={class:"space-y-4 text-sm"},Pe={class:"flex items-center gap-3"},Se={class:"w-10 h-10 rounded-full bg-[#BB4D00]/10 text-[#BB4D00] flex items-center justify-center font-bold shadow-inner"},Ke={class:"font-bold text-gray-900"},$e={class:"text-xs text-gray-500"},ze={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100"},Ae={class:"text-xs text-gray-500 leading-relaxed mb-4"},Le=["href"],Ie={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100"},Te={class:"flex flex-col gap-3"},Ee=["disabled"],Re={key:0,class:"text-[10px] text-gray-400 mt-2 text-center italic"},Ne={__name:"ReportDetail",props:{report:Object,vendor:Object},setup(r){const l=r,m=z(null),D=()=>{m.value.click()},C=s=>{const t=s.target.files[0];if(t){if(t.type!=="application/pdf"){alert("Mohon upload file dalam format PDF.");return}confirm(`Apakah Anda yakin ingin mengunggah "${t.name}" sebagai kontrak kerja?`)&&h.post(route("vendor.reports.uploadContract",l.report.id),{_method:"post",contract_file:t},{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{alert("Kontrak berhasil diunggah!")},onError:g=>{console.error(g),alert("Gagal mengunggah kontrak.")}})}},k=f(()=>{if(!l.report.evidence_files)return[];if(Array.isArray(l.report.evidence_files))return l.report.evidence_files;try{return JSON.parse(l.report.evidence_files)}catch{return[]}}),F=s=>s.match(/\.(jpeg|jpg|gif|png|webp|bmp)$/i),c=_({final_price:l.report.final_price||""}),M=()=>{c.patch(route("vendor.reports.updateFinalPrice",l.report.id),{preserveScroll:!0,onSuccess:()=>{h.reload({only:["report"]})},onError:s=>console.log(s)})},P=s=>s?"Rp "+parseFloat(s).toLocaleString("id-ID",{minimumFractionDigits:0}):"Rp 0";f(()=>{var t;let s=((t=l.report.user)==null?void 0:t.no_telepon)||"";return s.startsWith("0")&&(s="62"+s.slice(1)),`https://wa.me/${s}?text=Halo, saya dari ${l.vendor.nama_mitra} ingin mendiskusikan proyek REQ-${l.report.id}`}),_({});const S=s=>({pending:{label:"Menunggu Pembayaran",class:"bg-[#CA8E31]"},process:{label:"Dalam Pengerjaan",class:"bg-[#4688FB]"},completed:{label:"Selesai",class:"bg-[#09A600]"},cancelled:{label:"Dibatalkan",class:"bg-red-500"}})[s]||{label:s,class:"bg-gray-500"},y=f(()=>S(l.report.status)),K=()=>{confirm("Apakah Anda yakin ingin membatalkan pesanan ini? Pesanan akan kembali terbuka untuk mitra lain.")&&h.post(route("vendor.reports.cancelSelection",l.report.id),{},{onSuccess:()=>{alert("Pesanan berhasil dibatalkan.")},onError:s=>{console.error(s),alert("Gagal membatalkan pesanan. "+(s.message||""))}})};return(s,t)=>{var g,v,w,B;return n(),o(j,null,[b(i(A),{title:`Detail REQ-${r.report.id}`},null,8,["title"]),b(U),e("div",V,[e("div",N,[e("div",Q,[e("div",H,[b(i(I),{href:s.route("vendor.dashboard"),class:"text-white/70 hover:text-white flex items-center gap-2 transition"},{default:L(()=>[...t[1]||(t[1]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M10 19l-7-7m0 0l7-7m-7 7h18","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),d(" Kembali ke Dashboard ",-1)])]),_:1},8,["href"]),t[2]||(t[2]=e("a",{href:"https://docs.google.com/document/d/1LYdgiC8T2FyuJtoUd2rndYsQIQ1ynflLHc_WRfBUhm8/edit?usp=sharing",target:"_blank",class:"inline-flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 border border-white/50 text-white text-xs font-bold rounded-lg backdrop-blur-sm transition shadow-sm"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),d(" Template Kontrak Kerja ")],-1))]),e("div",O,[e("h1",G,"REQ-"+a(r.report.id),1),e("span",{class:x(`px-4 py-1.5 rounded-lg text-white text-[11px] font-bold uppercase tracking-wider shadow-md ${y.value.class}`)},a(y.value.label),3)]),e("p",J,a(r.report.title),1)])]),e("div",q,[e("div",W,[e("div",Y,[t[17]||(t[17]=e("h3",{class:"text-xl font-bold text-gray-800 flex items-center gap-2"},[e("svg",{class:"w-6 h-6 text-[#BB4D00]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),d(" Timeline Pekerjaan ")],-1)),e("div",X,[t[11]||(t[11]=e("div",{class:"flex flex-col items-center"},[e("div",{class:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white shadow-sm"},"✓"),e("div",{class:"w-0.5 h-full bg-gray-200"})],-1)),e("div",Z,[t[10]||(t[10]=e("div",{class:"flex justify-between items-start mb-4"},[e("h4",{class:"font-bold text-gray-800"},"Pengajuan Disetujui"),e("span",{class:"text-xs text-gray-400"},"Diverifikasi Admin")],-1)),e("div",ee,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-gray-400 uppercase text-[10px] font-bold tracking-widest mb-1"},"Kategori Kerusakan",-1)),e("div",{class:x(["inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold uppercase",r.report.category==="Berat"?"bg-red-100 text-red-600":r.report.category==="Sedang"?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600"])}," Kerusakan "+a(r.report.category||"-"),3)]),e("div",null,[t[4]||(t[4]=e("p",{class:"text-gray-400 uppercase text-[10px] font-bold tracking-widest mb-1"},"Jenis Kerusakan",-1)),e("p",te,a(((g=r.report.damage_types)==null?void 0:g.join(", "))||"-"),1)]),e("div",null,[t[5]||(t[5]=e("p",{class:"text-gray-400 uppercase text-[10px] font-bold tracking-widest mb-1"},"Deskripsi Masalah",-1)),e("p",re,a(r.report.description),1)]),e("div",null,[t[9]||(t[9]=e("p",{class:"text-gray-400 uppercase text-[10px] font-bold tracking-widest mb-2"},"Bukti Kerusakan",-1)),k.value.length>0?(n(),o("div",se,[(n(!0),o(j,null,T(k.value,(p,$)=>(n(),o("a",{key:$,href:`/storage/${p}`,target:"_blank",class:"block aspect-square rounded-lg overflow-hidden border border-gray-200 relative group cursor-pointer shadow-sm"},[F(p)?(n(),o("img",{key:0,src:`/storage/${p}`,class:"w-full h-full object-cover transition duration-300 group-hover:scale-110",alt:"Bukti"},null,8,ae)):(n(),o("div",ne,[...t[6]||(t[6]=[e("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])])),t[7]||(t[7]=e("div",{class:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"},[e("span",{class:"bg-white text-xs font-bold px-2 py-1 rounded text-black shadow-sm hover:bg-gray-100"},"Lihat")],-1))],8,oe))),128))])):(n(),o("div",le,[...t[8]||(t[8]=[e("p",{class:"text-xs text-gray-400 italic"},"Tidak ada lampiran foto/video.",-1)])]))])])])]),e("div",ie,[e("div",de,[e("div",{class:x([r.report.final_price?"bg-green-500":"bg-gray-200","w-8 h-8 rounded-full flex items-center justify-center text-white shadow-sm transition-colors"])},a(r.report.final_price?"✓":"2"),3)]),e("div",ce,[t[15]||(t[15]=e("h4",{class:"font-bold text-gray-800 mb-2"},"Kerja Sama Disetujui Client",-1)),t[16]||(t[16]=e("p",{class:"text-sm text-gray-500 mb-6 leading-relaxed"},"Diskusikan harga final dengan client melalui chat, lalu input biaya akhir pada panel informasi pembayaran.",-1)),e("div",pe,[e("div",ue,[e("input",{type:"file",ref_key:"contractInput",ref:m,class:"hidden",accept:"application/pdf",onChange:C},null,544),e("button",{onClick:D,class:"flex-1 w-full min-w-[140px] py-3 bg-[#4B741F] hover:bg-[#3d5e18] text-white font-bold rounded-xl shadow-md transition font-['Montserrat'] flex items-center justify-center gap-2"},[t[12]||(t[12]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),d(" "+a(r.report.contract_file?"Ganti Kontrak (PDF)":"Upload Kontrak (PDF)"),1)]),r.report.contract_file?(n(),o("div",ge,[e("a",{href:r.report.contract_file,target:"_blank",class:"text-xs text-[#4B741F] font-bold hover:underline inline-flex items-center gap-1"},[...t[13]||(t[13]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),d(" Lihat File Kontrak ",-1)])],8,xe)])):u("",!0)]),e("a",{href:`/chat/${r.report.user_id}`,target:"_blank",class:"flex-1 min-w-[140px] py-3 bg-[#2F2F2F] hover:bg-black text-white font-bold rounded-xl text-center shadow-md transition flex items-center justify-center gap-2 font-['Montserrat']"},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),d(" Chat Customer ",-1)])],8,fe)])])])])]),e("div",be,[e("div",he,[t[21]||(t[21]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",{class:"text-orange-500 font-bold"},"$"),d(" Informasi Pembayaran ")],-1)),e("div",me,[!r.report.final_price||r.report.final_price==0?(n(),o("div",ke,[t[18]||(t[18]=e("p",{class:"text-xs text-gray-400 uppercase font-bold tracking-wider"},"Input Total Biaya Fix",-1)),e("div",ye,[E(e("input",{"onUpdate:modelValue":t[0]||(t[0]=p=>i(c).final_price=p),type:"number",class:"w-full border-gray-200 rounded-lg text-sm focus:ring-[#BB4D00] focus:border-[#BB4D00]",placeholder:"Contoh: 350000"},null,512),[[R,i(c).final_price]]),e("button",{onClick:M,disabled:i(c).processing,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 rounded-lg text-xs font-bold transition flex items-center"},a(i(c).processing?"Menyimpan...":"Simpan"),9,ve)]),i(c).errors.final_price?(n(),o("p",we,a(i(c).errors.final_price),1)):u("",!0)])):(n(),o("div",Be,[t[20]||(t[20]=e("div",{class:"bg-green-50 p-3 rounded-lg border border-green-100"},[e("p",{class:"text-green-700 text-xs font-bold flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),d(" Harga deal telah ditetapkan ")])],-1)),e("div",_e,[e("div",null,[t[19]||(t[19]=e("p",{class:"text-xs text-gray-400 font-bold uppercase tracking-widest mb-1"},"Biaya Fix",-1)),e("p",je,a(P(r.report.final_price)),1)]),r.report.status==="pending"?(n(),o("div",De," Belum Dibayar ")):r.report.status==="payment_verification"||r.report.status==="process"?(n(),o("div",Ce," Sudah Dibayar ")):u("",!0)])]))])]),e("div",Fe,[t[22]||(t[22]=e("h3",{class:"font-bold text-gray-800 mb-4"},"Informasi Client",-1)),e("div",Me,[e("div",Pe,[e("div",Se,a((v=r.report.user)==null?void 0:v.name.charAt(0)),1),e("div",null,[e("p",Ke,a((w=r.report.user)==null?void 0:w.name),1),e("p",$e,a((B=r.report.user)==null?void 0:B.email),1)])])])]),e("div",ze,[t[23]||(t[23]=e("h3",{class:"font-bold text-gray-800 mb-2"},"Lokasi Perbaikan",-1)),e("p",Ae,a(r.report.location),1),e("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(r.report.location)}`,target:"_blank",class:"block w-full text-center py-2.5 border border-[#BB4D00] text-[#BB4D00] hover:bg-orange-50 font-bold rounded-xl transition text-xs"},"Lihat di Maps",8,Le)]),e("div",Ie,[t[24]||(t[24]=e("h3",{class:"font-bold text-gray-800 mb-4"},"Tindakan Pesanan",-1)),e("div",Te,[r.report.status==="pending"&&!r.report.final_price?(n(),o("button",{key:0,onClick:K,class:"w-full bg-red-50 text-red-600 px-4 py-3 rounded-xl font-bold border border-red-200 hover:bg-red-100 transition"}," Batalkan Pesanan ")):u("",!0),e("div",null,[e("button",{disabled:r.report.status!=="process",class:x([r.report.status==="process"?"bg-[#4B741F] hover:bg-[#3d5e18] text-white shadow-lg":"bg-gray-200 text-gray-400 cursor-not-allowed","w-full py-4 font-bold rounded-xl transition"])}," Tandai Selesai ",10,Ee),r.report.status==="process"?(n(),o("p",Re," Klik jika pekerjaan telah rampung 100%. ")):u("",!0)])])])])])])],64)}}};export{Ne as default};
