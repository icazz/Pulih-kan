import{q as h,s as y,a,b as x,d as e,u as i,h as w,f as B,g as c,l as D,t as r,e as g,k as M,F as m,j as S,x as L,i as f,y as z,v as C,o as l}from"./app-D2qwEyaT.js";import{L as p}from"./leaflet-src-BHe3LKqB.js";import{i as j,a as T}from"./marker-shadow-CG7pbA2w.js";const I={class:"h-screen w-full flex flex-col md:flex-row overflow-hidden bg-white"},V={class:"w-full md:w-1/2 h-1/2 md:h-full relative bg-gray-100 order-2 md:order-1"},A={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-white border-l border-gray-200 order-1 md:order-2 shadow-2xl z-10"},P={class:"bg-[#28160A] p-8 text-white flex-shrink-0"},R={class:"text-white/70 mt-1"},U={class:"mt-4 inline-block px-3 py-1 rounded bg-white/10 border border-white/20 text-xs font-mono"},K={class:"flex-1 overflow-y-auto p-8 space-y-8"},E={class:"space-y-6"},F={class:"text-xl font-bold text-gray-900 leading-tight"},N={class:"text-gray-700"},$={class:"bg-gray-50 p-6 rounded-2xl border border-gray-100"},O={class:"text-gray-800 leading-relaxed"},G={class:"grid grid-cols-2 gap-6"},J={class:"font-bold text-lg"},q={key:0,class:"p-4 bg-green-50 rounded-xl border border-green-100"},H={class:"font-bold text-lg text-green-700"},Q=["href"],W={key:1,class:"block w-full p-4 bg-gray-50 rounded-xl border border-gray-200 cursor-not-allowed opacity-70"},X={class:"flex flex-wrap gap-2"},Y={key:0,class:"text-gray-400 italic text-sm"},Z={key:0,class:"bg-gradient-to-r from-orange-50 to-white p-5 rounded-2xl border border-orange-200 shadow-sm relative overflow-hidden"},_={class:"flex items-start gap-4 relative z-10"},ee={class:"w-12 h-12 rounded-full bg-[#BB4D00] text-white flex items-center justify-center font-bold text-xl shadow-md"},te={class:"flex-1"},oe={class:"text-lg font-bold text-gray-900 leading-tight"},re={class:"text-sm text-gray-600 mt-1 flex flex-col gap-1"},se={class:"flex items-center gap-2"},ae={class:"flex items-center gap-2"},le={class:"truncate max-w-[200px]"},ne={class:"pt-8 border-t border-gray-100"},ie={key:0,class:"bg-orange-50 p-6 rounded-2xl border border-orange-200"},de={class:"grid grid-cols-2 gap-4 mb-6"},ue={class:"flex gap-3"},pe=["disabled"],be={key:1,class:"bg-blue-50 p-6 rounded-2xl border border-blue-200 text-center"},ge={class:"text-2xl font-black text-blue-600 mb-6"},ce={key:2,class:"bg-green-50 p-6 rounded-2xl border border-green-200 text-center"},xe={class:"text-xl font-bold text-green-700 mb-4"},me={key:3,class:"text-center p-6 bg-gray-50 border border-gray-200 rounded-xl text-gray-500"},fe={key:0,class:"font-bold text-lg mb-2 text-gray-700"},ye={__name:"ReportDetail",props:{report:Object,auth:Object},setup(o){let k=p.icon({iconUrl:T,shadowUrl:j,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});p.Marker.prototype.options.icon=k;const d=o,n=h({action:"",price:d.report.price||"",category:d.report.category||""});y(()=>{const u=parseFloat(d.report.latitude)||-6.175392,t=parseFloat(d.report.longitude)||106.827153,s=p.map("detailMap").setView([u,t],15);p.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(s),p.marker([u,t]).addTo(s).bindPopup(d.report.location).openPopup()});const b=u=>{if(!confirm("Apakah Anda yakin ingin memproses status ini?"))return;n.action=u;const t=`/admin/reports/${d.report.id}/status`;console.log("MENGIRIM KE URL:",t),n.patch(t,{preserveScroll:!0,onSuccess:()=>{alert("Status berhasil diperbarui!")},onError:s=>{console.error("Error update:",s),alert("Gagal update status: "+JSON.stringify(s))}})};return(u,t)=>(l(),a(m,null,[x(i(w),{title:`Detail Laporan #${o.report.id}`},null,8,["title"]),e("div",I,[e("div",V,[t[7]||(t[7]=e("div",{id:"detailMap",class:"w-full h-full z-0"},null,-1)),x(i(D),{href:u.route("admin.dashboard"),class:"absolute top-6 left-6 z-[400] bg-white text-gray-800 px-4 py-2 rounded-full shadow-lg font-bold flex items-center gap-2 hover:bg-gray-50 transition"},{default:B(()=>[...t[6]||(t[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),c(" Kembali ke Dashboard ",-1)])]),_:1},8,["href"])]),e("div",A,[e("div",P,[t[8]||(t[8]=e("h1",{class:"text-2xl font-bold"},"Detail Pengajuan",-1)),e("p",R,"ID: REQ-"+r(o.report.id)+" â€¢ Client: "+r(o.report.user?o.report.user.name:"User"),1),e("div",U," Status: "+r(o.report.status.toUpperCase()),1)]),e("div",K,[e("div",E,[e("div",null,[t[9]||(t[9]=e("label",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1"},"Judul Laporan",-1)),e("p",F,r(o.report.title),1)]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1"},"Lokasi",-1)),e("p",N,r(o.report.location),1)]),e("div",$,[t[11]||(t[11]=e("label",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest block mb-2"},"Deskripsi Masalah",-1)),e("p",O,r(o.report.description),1)]),e("div",G,[e("div",{class:M(["p-4 bg-gray-50 rounded-xl border border-gray-100",{"col-span-2":o.report.status==="process"||o.report.status==="completed"}])},[t[12]||(t[12]=e("label",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1"},"Luas Area",-1)),e("p",J,r(o.report.house_size||"-"),1)],2),o.report.status!=="process"&&o.report.status!=="completed"?(l(),a("div",q,[t[13]||(t[13]=e("label",{class:"text-xs font-bold text-green-600 uppercase tracking-widest block mb-1"},"Estimasi Biaya",-1)),e("p",H,r(o.report.price?"Rp "+parseInt(o.report.price).toLocaleString("id-ID"):"Belum ditentukan"),1)])):g("",!0)]),e("div",null,[o.report.drive_link?(l(),a("a",{key:0,href:o.report.drive_link,target:"_blank",class:"block w-full p-4 bg-blue-50 rounded-xl border border-blue-100 hover:bg-blue-100 transition cursor-pointer group relative z-20"},[...t[14]||(t[14]=[e("label",{class:"text-xs font-bold text-blue-400 uppercase tracking-widest block mb-1 cursor-pointer group-hover:text-blue-500"},"Bukti Foto/Video",-1),e("div",{class:"font-bold text-blue-700 flex items-center gap-2"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})]),c(" Buka Link Google Drive ")],-1)])],8,Q)):(l(),a("div",W,[...t[15]||(t[15]=[e("label",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1"},"Bukti Foto/Video",-1),e("div",{class:"font-bold text-gray-400 flex items-center gap-2"},"Tidak ada link dilampirkan",-1)])]))]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest block mb-2"},"Checklist Kerusakan",-1)),e("div",X,[(l(!0),a(m,null,S(o.report.damage_types,(s,v)=>(l(),a("span",{key:v,class:"px-3 py-1 rounded-full bg-red-50 text-red-700 text-sm font-medium border border-red-100"},r(s),1))),128)),o.report.damage_types?.length?g("",!0):(l(),a("span",Y,"Tidak ada data checklist."))])])]),o.report.vendor&&o.report.status!=="verification"?(l(),a("div",Z,[t[20]||(t[20]=L('<div class="absolute -right-4 -top-4 opacity-5 pointer-events-none"><svg class="w-32 h-32 text-[#BB4D00]" fill="currentColor" viewBox="0 0 24 24"><path d="M12 14l9-5-9-5-9 5 9 5z"></path><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"></path></svg></div><label class="text-xs font-bold text-orange-800 uppercase tracking-widest block mb-3 flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-[#BB4D00]"></span> Mitra Pelaksana (Dipilih User) </label>',2)),e("div",_,[e("div",ee,r(o.report.vendor.nama_mitra.charAt(0)),1),e("div",te,[e("h4",oe,r(o.report.vendor.nama_mitra),1),e("div",re,[e("div",se,[t[17]||(t[17]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),e("span",null,r(o.report.vendor.no_telepon),1)]),e("div",ae,[t[18]||(t[18]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),e("span",le,r(o.report.vendor.alamat||"Alamat tidak tersedia"),1)])])]),t[19]||(t[19]=e("div",{class:"hidden sm:block"},[e("span",{class:"px-3 py-1 bg-green-100 text-green-700 text-[10px] uppercase font-bold rounded-full border border-green-200 tracking-wide"}," Terverifikasi ")],-1))])])):g("",!0),e("div",ne,[t[29]||(t[29]=e("h3",{class:"font-bold text-[#BB4D00] text-lg mb-6 uppercase tracking-wide flex items-center gap-2"},[e("span",{class:"w-8 h-[2px] bg-[#BB4D00]"}),c(" Tindakan Admin ")],-1)),o.report.status==="verification"?(l(),a("div",ie,[e("div",de,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-xs font-bold text-gray-600 mb-1"},"Kategori Kerusakan",-1)),f(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>i(n).category=s),class:"w-full rounded-xl border-gray-300 focus:ring-[#BB4D00] focus:border-[#BB4D00]"},[...t[21]||(t[21]=[e("option",{value:"",disabled:""},"Pilih Kategori...",-1),e("option",{value:"Ringan"},"Ringan",-1),e("option",{value:"Sedang"},"Sedang",-1),e("option",{value:"Berat"},"Berat",-1)])],512),[[z,i(n).category]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-xs font-bold text-gray-600 mb-1"},"Input Estimasi Biaya (Rp)",-1)),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>i(n).price=s),type:"number",placeholder:"0",class:"w-full rounded-xl border-gray-300 focus:ring-[#BB4D00] focus:border-[#BB4D00]"},null,512),[[C,i(n).price]])])]),e("div",ue,[e("button",{onClick:t[2]||(t[2]=s=>b("verify")),disabled:i(n).processing||!i(n).price||!i(n).category,class:"flex-1 bg-[#BB4D00] hover:bg-[#903000] text-white py-3 rounded-xl font-bold transition disabled:opacity-50 shadow-lg shadow-orange-200 disabled:cursor-not-allowed"}," Verifikasi & Kirim Penawaran ",8,pe),e("button",{onClick:t[3]||(t[3]=s=>b("cancel")),class:"px-6 py-3 bg-white border border-red-200 text-red-600 rounded-xl font-bold hover:bg-red-50 transition"}," Tolak ")])])):o.report.status==="pending"?(l(),a("div",be,[t[24]||(t[24]=e("h4",{class:"text-blue-900 font-bold mb-1"},"Menunggu Pilihan Mitra & Pembayaran User",-1)),t[25]||(t[25]=e("p",{class:"text-sm text-blue-600 mb-4"},"User sedang memilih mitra dan melakukan pembayaran.",-1)),e("p",ge,"Rp "+r(parseInt(i(n).price).toLocaleString("id-ID")),1),e("button",{onClick:t[4]||(t[4]=s=>b("confirm_payment")),class:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-bold transition shadow-lg shadow-blue-200"}," Konfirmasi Pembayaran Diterima (Manual) ")])):o.report.status==="process"?(l(),a("div",ce,[t[26]||(t[26]=e("h4",{class:"text-green-900 font-bold mb-1"},"Proyek Dalam Pengerjaan",-1)),e("p",xe,"Total Biaya: Rp "+r(parseInt(o.report.price).toLocaleString("id-ID")),1),t[27]||(t[27]=e("p",{class:"text-green-800 mb-4 font-medium text-sm"},"Klik tombol di bawah jika pengerjaan telah selesai sepenuhnya.",-1)),e("button",{onClick:t[5]||(t[5]=s=>b("complete")),class:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold transition shadow-lg shadow-green-200"}," Tandai Pesanan Selesai ")])):(l(),a("div",me,[o.report.price?(l(),a("p",fe," Total Transaksi: Rp "+r(parseInt(o.report.price).toLocaleString("id-ID")),1)):g("",!0),t[28]||(t[28]=e("p",null,"Laporan selesai. Tidak ada tindakan yang diperlukan.",-1))]))]),t[30]||(t[30]=e("div",{class:"h-20"},null,-1))])])])],64))}};export{ye as default};
