import{r as k,m as S,p as z,D as U,a as r,b as w,d as t,u as s,h as M,q as T,n as p,g as d,B as y,v as m,f as E,F as x,i as C,e as h,t as v,o as n}from"./app-ChzUFhyI.js";import{_ as K}from"./Navbar-DOKeF_Ye.js";import{L as c,i as P,a as R}from"./marker-shadow-DVCR_t-s.js";const N={class:"min-h-screen bg-[#FFFFFA] font-['Montserrat'] pb-20"},$={class:"max-w-5xl mx-auto mt-12 mb-16 px-6"},I={class:"flex items-center justify-between relative w-full max-w-2xl mx-auto"},J={class:"relative z-10 bg-[#FFFFFA] px-3"},H={class:"relative z-10 bg-[#FFFFFA] px-3"},O={class:"max-w-5xl mx-auto px-6"},q={class:"mb-6"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"},Z=["onClick"],Q={class:"w-5 h-5 rounded border border-[#973C00] flex items-center justify-center bg-white"},X={key:0,class:"w-3 h-3 bg-[#973C00] rounded-sm"},Y={class:"text-[#4F3726] font-medium select-none"},ee={class:"mb-6"},te={key:0,class:"flex gap-2 mt-4 flex-wrap"},ae=["src"],oe={key:1,class:"w-full h-full bg-black text-white flex items-center justify-center rounded-lg text-xs text-center p-1"},se={key:1,class:"text-red-500 text-sm mt-1"},le={class:"mb-10"},ie={class:"flex justify-between items-center mt-12"},re=["disabled"],ce={__name:"Create",setup(ne){let F=c.icon({iconUrl:R,shadowUrl:P,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});c.Marker.prototype.options.icon=F;const i=k(1),g=k([]),a=S({title:"",provinsi:"",kota:"",alamat:"",location:"",house_size:"",latitude:"",longitude:"",damage_types:[],evidence:[],deskripsi:""}),_=["Saluran Air Rusak","Pembersihan Lumpur dan Puing","Instalasi Listrik Rusak","Atap Bocor / Rusak","Muncul Jamur dan Lembab","Lainnya"],B=l=>{a.damage_types.includes(l)?a.damage_types=a.damage_types.filter(e=>e!==l):a.damage_types.push(l)},A=l=>{const e=Array.from(l.target.files);a.evidence=e,g.value=e.map(o=>o.type.startsWith("image/")?URL.createObjectURL(o):null)},D=()=>{if(i.value===1){if(!a.title||!a.alamat||!a.provinsi||!a.kota||!a.latitude){alert("Mohon lengkapi judul, data rumah, dan pilih titik lokasi di peta.");return}i.value++,window.scrollTo({top:0,behavior:"smooth"})}},j=()=>{i.value>1&&(i.value--,window.scrollTo({top:0,behavior:"smooth"}))},L=()=>{if(a.damage_types.length===0||!a.deskripsi||a.evidence.length===0){alert("Mohon lengkapi kerusakan, deskripsi, dan upload bukti foto/video.");return}a.location=`${a.alamat}, ${a.kota}, ${a.provinsi}`,a.post(route("reports.store"),{forceFormData:!0,onSuccess:()=>{},onError:l=>{console.error("Error submit:",l),l["evidence.0"]?alert("Salah satu file terlalu besar atau format tidak sesuai."):alert("Gagal mengirim laporan. Cek kembali isian Anda.")}})};z(()=>{i.value===1&&U(()=>{setTimeout(V,500)})});let u,b;const V=()=>{if(!document.getElementById("mapContainer")||u)return;u=c.map("mapContainer").setView([-6.2,106.816666],13),c.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap",maxZoom:19}).addTo(u);const l=(e,o)=>{b?b.setLatLng([e,o]):b=c.marker([e,o]).addTo(u),u.setView([e,o],16),a.latitude=e,a.longitude=o};navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{l(e.coords.latitude,e.coords.longitude)}),u.on("click",e=>l(e.latlng.lat,e.latlng.lng))};return(l,e)=>(n(),r(x,null,[w(s(M),{title:"Pengajuan Pemulihan Rumah"}),w(K),t("div",N,[e[17]||(e[17]=T('<div class="w-full bg-gradient-to-r from-[#28160A] via-[#000000] to-[#2D190D] pt-32 pb-16 shadow-lg"><div class="max-w-5xl mx-auto px-6"><h1 class="text-3xl md:text-5xl font-bold text-[#FFEBDE] mb-3 leading-tight"> Pengajuan <br class="md:hidden"> Perbaikan Rumah </h1><p class="text-white text-base md:text-lg opacity-90 font-light"> Lengkapi data untuk mendapatkan perbaikan </p></div></div>',1)),t("div",$,[t("div",I,[e[6]||(e[6]=t("div",{class:"absolute top-1/2 left-0 w-full h-[4px] bg-[#D6C5BA] z-0 transform -translate-y-1/2 rounded-full"},null,-1)),t("div",J,[t("div",{class:p(["w-16 h-16 rounded-full flex items-center justify-center border-[3px] transition-all duration-300 shadow-sm",i.value===1?"bg-[#973C00] border-[#973C00]":"bg-[#D6C5BA] border-[#D6C5BA]"])},[t("img",{src:"/images/step-1-home.png",class:p(["w-8 h-8 object-contain brightness-0 invert",i.value===1?"opacity-100":"opacity-60"])},null,2)],2)]),t("div",H,[t("div",{class:p(["w-16 h-16 rounded-full flex items-center justify-center border-[3px] transition-all duration-300 shadow-sm",i.value===2?"bg-[#973C00] border-[#973C00]":"bg-[#D6C5BA] border-[#D6C5BA]"])},[t("img",{src:"/images/step-2-alert.png",class:p(["w-8 h-8 object-contain brightness-0 invert",i.value===2?"opacity-100":"opacity-60"])},null,2)],2)]),e[7]||(e[7]=t("div",{class:"relative z-10 bg-[#FFFFFA] px-3"},[t("div",{class:"w-16 h-16 rounded-full flex items-center justify-center border-[3px] transition-all duration-300 shadow-sm bg-[#D6C5BA] border-[#D6C5BA]"},[t("img",{src:"/images/step-3-file.png",class:"w-8 h-8 object-contain brightness-0 invert opacity-60"})])],-1))])]),t("div",O,[d(t("div",null,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold text-black mb-6"},"Data Rumah",-1)),t("div",q,[e[8]||(e[8]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Judul Laporan",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>s(a).title=o),placeholder:"Contoh: Atap Roboh Bagian Dapur",class:"w-full bg-white border border-gray-300 rounded-xl px-4 py-3 text-gray-700 focus:ring-2 focus:ring-[#973C00] shadow-sm"},null,512),[[m,s(a).title]])]),t("div",G,[t("div",null,[d(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>s(a).provinsi=o),placeholder:"Provinsi (Contoh: Jawa Timur)",class:"w-full bg-white border border-gray-300 rounded-xl px-4 py-3 text-gray-700 focus:ring-2 focus:ring-[#973C00] shadow-sm"},null,512),[[m,s(a).provinsi]])]),t("div",null,[d(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>s(a).kota=o),placeholder:"Kecamatan / Kota",class:"w-full bg-white border border-gray-300 rounded-xl px-4 py-3 text-gray-700 focus:ring-2 focus:ring-[#973C00] shadow-sm"},null,512),[[m,s(a).kota]])]),t("div",null,[d(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>s(a).alamat=o),placeholder:"Alamat Lengkap",class:"w-full bg-white border border-gray-300 rounded-xl px-4 py-3 text-gray-700 focus:ring-2 focus:ring-[#973C00] shadow-sm"},null,512),[[m,s(a).alamat]])]),t("div",null,[d(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=o=>s(a).house_size=o),placeholder:"Luas Rumah (mÂ²)",class:"w-full bg-white border border-gray-300 rounded-xl px-4 py-3 text-gray-700 focus:ring-2 focus:ring-[#973C00] shadow-sm"},null,512),[[m,s(a).house_size]])])]),e[11]||(e[11]=t("div",{class:"mb-8"},[t("h3",{class:"text-[#4F3726] font-bold mb-3 flex items-center gap-2"},"Pilih Titik di Peta"),t("div",{id:"mapContainer",class:"w-full h-64 md:h-80 rounded-2xl overflow-hidden border border-gray-300 shadow-md relative z-0"})],-1)),t("div",{class:"flex justify-end mt-12"},[t("button",{onClick:D,class:"px-8 py-3 rounded-full text-white font-bold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all flex items-center gap-2 bg-gradient-to-r from-[#552300] to-[#BB4D00]"},[...e[9]||(e[9]=[E(" Lanjutkan ",-1),t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})],-1)])])])],512),[[y,i.value===1]]),d(t("div",null,[e[16]||(e[16]=t("h2",{class:"text-2xl font-bold text-black mb-6"},"Kondisi Kerusakan",-1)),t("div",W,[(n(),r(x,null,C(_,(o,f)=>t("div",{key:f,onClick:de=>B(o),class:p(["cursor-pointer rounded-xl p-4 flex items-center gap-3 border transition-all duration-200",s(a).damage_types.includes(o)?"bg-[#FFFBEE] border-[#973C00] shadow-md":"bg-[#FFFBEE] border-[#973C00] hover:shadow-sm"])},[t("div",Q,[s(a).damage_types.includes(o)?(n(),r("div",X)):h("",!0)]),t("span",Y,v(o),1)],10,Z)),64))]),t("div",ee,[e[12]||(e[12]=t("label",{class:"block text-gray-700 font-bold mb-2"},"Foto/Video Bukti Kerusakan",-1)),t("input",{type:"file",multiple:"",accept:"image/*,video/*",onChange:A,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[#F2A900] file:text-white hover:file:bg-orange-600 cursor-pointer"},null,32),e[13]||(e[13]=t("p",{class:"text-xs text-gray-500 mt-1"},"*Bisa pilih lebih dari satu foto/video.",-1)),g.value.length?(n(),r("div",te,[(n(!0),r(x,null,C(g.value,(o,f)=>(n(),r("div",{key:f,class:"relative w-24 h-24"},[o?(n(),r("img",{key:0,src:o,class:"w-full h-full object-cover rounded-lg border border-gray-300"},null,8,ae)):(n(),r("div",oe," Video Selected "))]))),128))])):h("",!0),s(a).errors.evidence?(n(),r("div",se,v(s(a).errors.evidence),1)):h("",!0)]),t("div",le,[e[14]||(e[14]=t("label",{class:"block text-[#716363] text-lg mb-2 font-medium"},"Deskripsikan Kerusakan secara Detail",-1)),d(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=o=>s(a).deskripsi=o),rows:"5",class:"w-full bg-white border border-[#973C00] rounded-xl p-4 text-[#4F3726] focus:ring-2 focus:ring-[#973C00] shadow-sm",placeholder:"Contoh: Tembok ruang tamu retak parah..."},null,512),[[m,s(a).deskripsi]]),e[15]||(e[15]=t("p",{class:"text-sm text-gray-500 mt-2"},"*Hasil verifikasi akan diberikan maksimal dalam waktu 1 x 48 jam .",-1))]),t("div",ie,[t("button",{onClick:j,class:"flex items-center gap-2 text-[#696565] font-semibold hover:text-[#4F3726] transition"},"Kembali"),t("button",{onClick:L,disabled:s(a).processing,class:"px-8 py-3 rounded-full text-white font-bold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all flex items-center gap-2 bg-gradient-to-r from-[#552300] to-[#BB4D00]"},v(s(a).processing?"Mengirim...":"Verifikasi & Kirim"),9,re)])],512),[[y,i.value===2]])])])],64))}};export{ce as default};
